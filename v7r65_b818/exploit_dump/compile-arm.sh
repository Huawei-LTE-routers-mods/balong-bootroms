#!/bin/bash
arm-none-eabi-gcc -march=armv7-m -mtune=cortex-m3 -mthumb -fno-ident -O2 read.c -S -o read.s
arm-none-eabi-as -march=armv7-m -mthumb read.s -o read.o
arm-none-eabi-ld -N read.o -o read.out
arm-none-eabi-objcopy -O binary read.out read.bin_

cat read.bin_ > read.bin
rm read.bin_

xxd -ps -c999 read.bin | sed 's~\(..\)~\\x\1~g' > read.txt
echo >> read.txt
echo -n "size: " >> read.txt
stat -c%s read.bin >> read.txt
